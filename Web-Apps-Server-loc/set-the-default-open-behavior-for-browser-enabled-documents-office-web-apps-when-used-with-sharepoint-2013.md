---
title: Открытия документов с браузера (Office Web Apps)
TOCTitle: Настройка способа открытия документов с поддержкой браузера по умолчанию
ms:assetid: e27e0bc8-5fb5-4bb1-8157-d7c90654175e
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Ee837425(v=office.15)
ms:contentKeyID: 50181347
ms.date: 12/22/2017
mtps_version: v=office.15
ms.translationtype: HT
---

# Настройка способа открытия документов с поддержкой браузера по умолчанию (при использовании Office Web Apps с SharePoint 2013) 

_<strong>Применимо к:</strong> Office Web Apps, SharePoint Foundation 2013, SharePoint Server 2013_

_<strong>Последнее изменение раздела:</strong> 2016-12-16_

**Сводка.** В этой статье описывается, как настроить способ открытия документов Office по умолчанию в семействах сайтов и библиотеках документов SharePoint.

**Аудитория:** ИТ-специалисты

Чтобы открыть документ в библиотеке SharePoint 2013, можно просто нажать его. Где откроется документ: в клиентском приложении или браузере, зависит от нескольких факторов, в том числе типа файла, параметров фермы Сервер Office Web Apps и текущих параметров компонента OpenInClient библиотеки или семейства сайтов. Далее показано, как настроить режим открытия по умолчанию для документов Office, для которых SharePoint 2013 настроен на использование Сервер Office Web Apps.

## Настройка открытия документов из библиотек SharePoint 2013

Если SharePoint 2013 настроен для использования Сервер Office Web Apps, то по умолчанию файлы Word, PowerPoint, Excel и OneNote открываются в браузере. PDF-документы открываются в Word Web App. Вы можете изменить настройки по умолчанию, чтобы открывать файлы непосредственно в клиентских приложениях (или средстве просмотра PDF по умолчанию) двумя способами.

  - **Для фермы SharePoint 2013**. В ферме SharePoint 2013 вы можете настроить способ открытия по умолчанию для каждого типа файла с помощью командлетов [New-SPWOPIBinding](https://docs.microsoft.com/en-us/powershell/module/sharepoint-server/New-SPWOPIBinding?view=sharepoint-ps) и [Set-SPWOPIBinding](https://docs.microsoft.com/en-us/powershell/module/sharepoint-server/Set-SPWOPIBinding?view=sharepoint-ps)Windows PowerShell. Эти командлеты применяются также для [изменения поведения PDF-документов](http://go.microsoft.com/fwlink/p/?linkid=330246).

  - **Для семейств сайтов и библиотек документов**. Пользователи и администраторы семейств сайтов могут использовать функцию OpenInClient в SharePoint 2013, чтобы указать, где необходимо открывать файлы Office: в клиентском приложении или в браузере. Пользователи могут изменить соответствующий параметр в свойствах библиотеки документов, а администраторы семейства сайтов — в центре администрирования семейства или с помощью командлета [Enable-SPFeature](https://technet.microsoft.com/ru-ru/library/ff607803\(v=office.15\)), который включает функцию OpenInClient. В следующем разделе содержится информация о нескольких разных способах включения функции OpenInClient.

В целом, функция OpenInClient переопределяет все привязки WOPI, установленные между SharePoint 2013 и Сервер Office Web Apps. Иными словами, если компонент OpenInClient библиотеки или семейства сайтов SharePoint 2013 включен, документы будут открываться в клиентском приложении, даже если сервер SharePoint 2013 настроен на использование Сервер Office Web Apps.

> [!NOTE]
> Настройка используемого по умолчанию способа открытия документов с поддержкой браузера не влияет на то, смогут ли пользователи загружать документы, применяя функции <strong>Извлечь</strong> и <strong>Отправить</strong> в SharePoint 2013. Сведения о настройке разрешений извлечения, загрузки и просмотра в SharePoint 2013 см. в статье <a href="https://technet.microsoft.com/ru-ru/library/cc262939(v=office.15)">Планирование разрешений для сайтов и контента в SharePoint 2013</a>.


## Установите компонент для библиотеки документов или семейства сайтов

Используйте одну из следующих процедур для установки компонента OpenInClient в SharePoint 2013.

> [!NOTE]
> В некоторых процедурах, приведенных в этой статье, для выполнения командлетов SharePoint используется Командная консоль SharePoint 2013. Если вы решили использовать консоль Windows PowerShell, необходимо добавить оснастку Microsoft.SharePoint.PowerShell с помощью командлета <strong>Add-PSSnapin</strong>. Дополнительные сведения об использовании Windows PowerShell с SharePoint 2013 см. в статье <a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-server/?view=sharepoint-ps">Использование Windows PowerShell для администрирования SharePoint 2013</a>.


> [!NOTE]
> Для работы во всех выпусках Наборы Office 2013 можно использовать мышь, сочетания клавиш и сенсорные жесты. Сведения об использовании сочетаний клавиш и жестов с продуктами и службами Office см. в статье <a href="http://go.microsoft.com/fwlink/p/?linkid=249150">Сочетания клавиш</a> и <a href="http://go.microsoft.com/fwlink/p/?linkid=253163">справочнике по сенсорному управлению в Office</a>.


 **Настройка компонента OpenInClient для семейств сайтов**

1.  В семействе веб-сайтов SharePoint нажмите значок **Параметры** и выберите пункт **Параметры сайта**.

2.  На странице **Параметры сайта** в разделе **Администрирование семейства веб-сайтов** выберите **Возможности семейства веб-сайтов**.

3.  На странице **Возможности** для функции **Открывать документы в клиентских приложениях по умолчанию** выберите значение **Активировать**, чтобы включить функцию OpenInClient (документы будут открываться в клиентском приложении). Выберите **Отключить**, чтобы отключить функцию OpenInClient (документы будут открываться в браузере).

 **Настройка способа открытия по умолчанию для семейств сайтов с помощью Windows PowerShell**

1.  Убедитесь, что предоставлены следующие разрешения.
    
      - Предопределенная роль сервера **securityadmin** для экземпляра SQL Server.
    
      - Предопределенная роль базы данных **db\_owner** во всех базах данных, которые должны обновляться.
    
      - Группа администраторов для сервера, на котором выполняются командлеты Windows PowerShell.
    
    Также ознакомьтесь со статьей [о политиках выполнения](http://go.microsoft.com/fwlink/p/?linkid=193050) и добавьте другие необходимые членства.
    
    Администратор может использовать командлет **Add-SPShellAdmin**, чтобы предоставлять разрешения для использования командлетов продуктов SharePoint 2013.
    
    > [!NOTE]
	> Если у вас отсутствуют разрешения, обратитесь к администратору установки или администратору SQL Server и запросите соответствующие разрешения. Дополнительные сведения о разрешениях Windows PowerShell см. в статьях <a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-server/?view=sharepoint-ps">Разрешения</a> и <a href="https://technet.microsoft.com/ru-ru/library/ff607596(v=office.15)">Add-SPShellAdmin</a>.


2.  Открытие Командная консоль SharePoint 2013 с повышенными привилегиями.
    
    **Windows Server 2008**
    
    1.  В меню **Пуск** выберите **Все программы**.
    
    2.  Выберите **Продукты Microsoft SharePoint 2013**.
    
    3.  Выберите **командную консоль SharePoint 2013** и откройте контекстное меню (щелкните правой кнопкой мыши).
    
    4.  В контекстном меню выберите пункт **Запуск от имени администратора**.
    
    **Windows Server 2012**
    
    1.  Проведите пальцем в центр от края экрана, чтобы отобразить экспресс-кнопки, и нажмите **Поиск**, чтобы просмотреть все установленные на компьютере приложения.
    
    2.  Выберите (щелкните правой кнопкой мыши) **командную консоль SharePoint 2013**, чтобы отобразить панель приложений.
    
    3.  В панели приложения выберите **Запуск от имени администратора**.

3.  В командной строке Windows PowerShell введите одну из следующих команд.
    
      - Чтобы включить функцию OpenInClient для определенного семейства сайтов (чтобы открывать документы в клиентском приложении), введите команду:
        
        ```PowerShell
            Enable-SPFeature 8A4B8DE2-6FD8-41e9-923C-C7C3C00F8295 -url <SiteCollURL>
        ```
        ``` 
        где *\<SiteCollURL\>* — URL-адрес семейства веб-сайтов.
        ```
    
      - Чтобы включить функцию OpenInClient всех семейств сайтов (открывать документы в клиентском приложении), введите следующую команду:

        ```PowerShell  
            Get-SPSite -limit ALL |foreach{ Enable-SPFeature 8A4B8DE2-6FD8-41e9-923C-C7C3C00F8295 -url $_.URL }
        ```
    
      - Чтобы включить функцию OpenInClient для всех семейств сайтов (чтобы открывать документы в клиентском приложении), введите команду:

        ```PowerShell 
            Disable-SPFeature 8A4B8DE2-6FD8-41e9-923C-C7C3C00F8295 -url <SiteCollURL>
        ```
        ``` 
        где *\<SiteCollURL\>* — URL-адрес семейства веб-сайтов.
        ```
    
      - Чтобы отключить функцию OpenInClient для всех семейств сайтов (чтобы открывать документы в браузере), введите команду:

        ```PowerShell  
            Get-SPSite -limit ALL |foreach{ Disable-SPFeature 8A4B8DE2-6FD8-41e9-923C-C7C3C00F8295 -url $_.URL }
        ```

 **Настройка способа открытия по умолчанию для библиотеки документов с помощью страницы параметров библиотеки документов**

1.  На странице библиотеки документов откройте вкладку **Библиотека**.

2.  В группе **Параметры** выберите пункт **Параметры библиотеки**.

3.  На странице **Параметры библиотеки документов** выберите **Дополнительные параметры**.

4.  На странице **Дополнительные параметры** в поле **Открытие документов в браузере** выберите один из следующих параметров:
    
      - **Открыть в клиентском приложении**.   Если пользователь выбирает документ в этой библиотеке, он откроется в соответствующем клиентском приложении, если оно доступно.
    
      - **Открыть в браузере**.   Если пользователь выбирает документ в этой библиотеке, он откроется в веб-приложении для этого типа документов в браузере. После открытия документа в веб-приложении пользователь сможет открыть его в клиентском приложении.
    
      - **Использование настроек сервера по умолчанию**.   Если пользователь выбирает документ в этой библиотеке, он открывается способом, заданным на сервере SharePoint 2013 по умолчанию.

 **Настройка способа открытия по умолчанию для библиотек документов, защищенных IRM, с помощью Windows PowerShell**

1.  Убедитесь, что предоставлены следующие членства.
    
      - Предопределенная роль сервера **securityadmin** для экземпляра SQL Server.
    
      - Предопределенная роль базы данных **db\_owner** во всех базах данных, которые должны обновляться.
    
      - Группа администраторов для сервера, на котором выполняются командлеты Windows PowerShell.
    
    Также ознакомьтесь со статьей [о политиках выполнения](http://go.microsoft.com/fwlink/p/?linkid=193050) и добавьте другие необходимые членства.
    
    Администратор может использовать командлет **Add-SPShellAdmin**, чтобы предоставлять разрешения для использования командлетов продуктов SharePoint 2013.
    
    > [!NOTE]
	> Если у вас отсутствуют разрешения, обратитесь к администратору установки или администратору SQL Server и запросите соответствующие разрешения. Дополнительные сведения о разрешениях Windows PowerShell см. в статьях <a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-server/?view=sharepoint-ps">Разрешения</a> и <a href="https://technet.microsoft.com/ru-ru/library/ff607596(v=office.15)">Add-SPShellAdmin</a>.


2.  Открытие Командная консоль SharePoint 2013 с повышенными привилегиями.
    
    **Windows Server 2008**
    
    1.  В меню **Пуск** выберите **Все программы**.
    
    2.  Выберите **Продукты Microsoft SharePoint 2013**.
    
    3.  Выберите **командную консоль SharePoint 2013** и откройте контекстное меню (щелкните правой кнопкой мыши).
    
    4.  В контекстном меню выберите пункт **Запуск от имени администратора**.
    
    **Windows Server 2012**
    
    1.  Проведите пальцем в центр от края экрана, чтобы отобразить экспресс-кнопки, и нажмите **Поиск**, чтобы просмотреть все установленные на компьютере приложения.
    
    2.  Выберите (щелкните правой кнопкой мыши) **командную консоль SharePoint 2013**, чтобы отобразить панель приложений.
    
    3.  В панели приложения выберите **Запуск от имени администратора**.

3.  В командной строке Windows PowerShell введите следующую команду:
    
      ```PowerShell
        Get-SPWeb -site <SiteCollURL> | % {$_.Lists} | where {$_.IrmEnabled -eq $true} | % {$_.DefaultItemOpen =[Microsoft.Sharepoint.DefaultItemOpen]::<DefaultItemOpenSetting>; $_.Update()}
      ```
    
    где:
    
      - *\<SiteCollURL\>* — URL-адрес семейства сайтов, в которой размещаются библиотеки документов.
    
      - *\<DefaultItemOpenSetting\>* — это значение перечисления **DefaultItemOpen**, определяющее способ открытия документов по умолчанию. Используйте параметр **PreferClient**, чтобы открывать документы в соответствующем клиентском приложении (если оно доступно). Используйте параметр **Browser**, чтобы открывать документы в браузере.

## См. также


[Get-SPWOPIBinding](https://docs.microsoft.com/en-us/powershell/module/sharepoint-server/Get-SPWOPIBinding?view=sharepoint-ps)  


[План содержимого для сервера Office Web Apps](content-roadmap-for-office-web-apps-server.md)  
[Использование Windows PowerShell для администрирования SharePoint 2013](https://docs.microsoft.com/en-us/powershell/module/sharepoint-server/?view=sharepoint-ps)  
[Сервер Office Web Apps](office-web-apps-server.md)  


[Get-SPWeb](https://technet.microsoft.com/ru-ru/library/ff607807\(v=office.15\))  
[Get-SPSite](https://technet.microsoft.com/ru-ru/library/ff607950\(v=office.15\))  
[Get-SPFeature](https://technet.microsoft.com/ru-ru/library/ff607945\(v=office.15\))

