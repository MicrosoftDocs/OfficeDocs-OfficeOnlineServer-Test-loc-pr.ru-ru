---
title: Планирование сервера Office Web Apps
TOCTitle: Планирование сервера Office Web Apps
ms:assetid: 2e147f11-6f47-46bc-90bf-b2f179958d11
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ219435(v=office.15)
ms:contentKeyID: 49624470
ms.date: 12/22/2017
mtps_version: v=office.15
ms.translationtype: HT
---

# Планирование сервера Office Web Apps


_<strong>Применимо к:</strong> Office Web Apps Server_

_<strong>Последнее изменение раздела:</strong> 2017-10-10_

**Сводка**. В этой статье рассматриваются требования, предъявляемые сервером Office Web Apps, такие как протокол HTTPS, сертификаты, виртуализация, балансировка нагрузки, топологии и безопасность.

**Аудитория**. ИТ-специалисты

Сервер Office Web Apps предоставляет браузерные версии приложений Office в локальной среде, обеспечивая пользователям большую гибкость и возможности для совместной работы. В статье описываются требования и действия, необходимые для установки Сервер Office Web Apps в организации.

Важно тщательно все продумать, чтобы все узлы, такие как SharePoint 2013 и Lync Server 2013, могли обмениваться данными с Сервер Office Web Apps. Дополнительные рекомендации по настройке узлов см. в следующих статьях:

  - [Планирование Office Web Apps (используется вместе с SharePoint 2013)](plan-office-web-apps-used-with-sharepoint-2013.md)

  - [Настройка интеграции с сервером Office Web Apps и Lync Server 2013](https://go.microsoft.com/fwlink/p/?linkid=256902)

> [!NOTE]
> Продукты SharePoint 2010 не могут быть узлом для Сервер Office Web Apps. Сервер Office Web Apps не поддерживается SharePoint Foundation 2010 или SharePoint Server 2010. Сервер Office Web Apps также не поддерживается Exchange Server 2013.


В этой статье

  - Требования сервера Office Web Apps к программному обеспечению, оборудованию и конфигурации

  - Поддержка виртуализации на сервере Office Web Apps

  - Требования сервера Office Web Apps к брандмауэру

  - Требования сервера Office Web Apps к подсистеме балансировки нагрузки

  - Требования сервера Office Web Apps к службе доменных имен

  - Планирование языковых пакетов для сервера Office Web Apps

  - Планирование топологии для серверa Office Web Apps

  - Планирование системы безопасности для сервера Office Web Apps

  - Планирование Online Viewers с использованием сервера Office Web Apps

  - Планирование обновлений сервера Office Web Apps

## Требования сервера Office Web Apps к программному обеспечению, оборудованию и конфигурации

Сервер Office Web Apps можно установить в качестве фермы Сервер Office Web Apps с одним сервером или фермы Сервер Office Web Apps из нескольких серверов с балансировкой нагрузки. Можно использовать физические серверы или экземпляры виртуальных машин, однако установить другие серверные приложения (такие как SharePoint 2013 или SQL Server) на том же сервере, что и Сервер Office Web Apps, невозможно.

В средах, содержащих фактические данные пользователей, мы настоятельно советуем использовать протокол HTTPS, для которого необходимо получить сертификат. Если в вашей ферме несколько серверов, может потребоваться настроить аппаратное или программное решение для балансировки нагрузки. В следующих разделах описываются предварительные требования для этих сценариев.

## Требования сервера Office Web Apps к оборудованию

Минимальные требования Сервер Office Web Apps к оборудованию такие же, как и для SharePoint Server 2013. Полный перечень требований SharePoint 2013 к оборудованию см. в статье, содержащей [требования к оборудованию для веб-серверов, серверов приложений и конфигураций с одним сервером](https://technet.microsoft.com/ru-ru/4d88c402-24f2-449b-86a6-6e7afcfec0cd\(office.15\)#hwforwebserver).

## Операционные системы, поддерживаемые сервером Office Web Apps

Сервер Office Web Apps может работать в следующих операционных системах:

  - 64-разрядный выпуск Windows Server 2008 R2 с пакетом обновления 1 (SP1) Standard, Enterprise или Datacenter с установленным [обновлением](https://go.microsoft.com/fwlink/p/?linkid=236954)

  - 64-разрядный выпуск Windows Server 2012 Standard или Datacenter

  - 64-разрядный выпуск Windows Server 2012 R2. Чтобы использовать эту операционную систему, нужен сервер Office Web Apps с пакетом обновления 1 (SP1).

## Требования сервера Office Web Apps к домену

Все серверы в ферме Сервер Office Web Apps должны быть частью домена. Они могут находиться в одном и том же домене (рекомендуется) или в доменах одного и того же леса. Однако Сервер Office Web Apps не будет работать, если установить его на контроллере домена.

## Роли сервера, службы и другое программное обеспечение, необходимое для работы сервера Office Web Apps

Прежде всего, есть несколько вещей, которые НЕ СЛЕДУЕТ делать при развертывании Сервер Office Web Apps.

  - **На серверах с Сервер Office Web Apps не должны быть установлены другие серверные приложения**. К ним относятся Exchange Server, SharePoint Server, Lync Server и SQL Server. Если у вас не хватает серверов, Сервер Office Web Apps можно выполнять на экземпляре виртуальной машины на одном из существующих серверов.

  - **Не устанавливайте службы или роли, зависящие от роли веб-сервера IIS, в порт 80, 443 или 809**, так как Сервер Office Web Apps регулярно удаляет веб-приложения, расположенные в этих портах.

  - **Не устанавливайте какие-либо версии Office**. Все существующие версии этого набора необходимо удалить до установки Сервер Office Web Apps.

  - **Не устанавливайте Сервер Office Web Apps на контроллер домена**. Этот продукт не будет работать на сервере, на котором работают доменные службы Active Directory.

Подробные сведения об элементах, которые НЕОБХОДИМО установить, приведены в следующей таблице.

> [!IMPORTANT]
> Сервер Office Web Apps можно скачать только на веб-сайте <a href="https://go.microsoft.com/fwlink/p/?linkid=256561">Volume Licensing Service Center (VLSC)</a>. Для загрузки Сервер Office Web Apps необходима лицензия на Office профессиональный плюс 2013, Office стандартный 2013 или Office для Mac 2011, предусмотренная соглашением о корпоративном лицензировании. Загружаемые файлы находятся в разделах на портале VLSC, посвященных продуктам Office.


### Загрузки, роли сервера и компоненты, необходимые для работы сервера Office Web Apps

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Загрузка, роль сервера или компонент</th>
<th>При установке в Windows Server 2008 R2</th>
<th>При установке в Windows Server 2012</th>
<th>При установке в Windows Server 2012 R2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Загрузка:</strong> сервер Office Web Apps</p></td>
<td><p><a href="https://go.microsoft.com/fwlink/p/?linkid=256561">Сервер Office Web Apps</a></p></td>
<td><p><a href="https://go.microsoft.com/fwlink/p/?linkid=256561">Сервер Office Web Apps</a></p></td>
<td><p><a href="https://go.microsoft.com/fwlink/p/?linkid=256561">Сервер Office Web Apps</a></p></td>
</tr>
<tr class="even">
<td><p><strong>Загрузка:</strong> сервер Office Web Apps с пакетом обновления 1 (SP1)</p></td>
<td><p>Рекомендовано</p></td>
<td><p>Рекомендуемый</p></td>
<td><p><a href="https://go.microsoft.com/fwlink/p/?linkid=510097">Сервер Office Web Apps с пакетом обновления 1 (SP1)</a></p></td>
</tr>
<tr class="odd">
<td><p><strong>Загрузка:</strong> правильная версия платформы .NET Framework</p></td>
<td><p><a href="https://go.microsoft.com/fwlink/p/?linkid=256560">.NET Framework 4.5</a></p></td>
<td><p>Платформа .NET Framework 4.5 уже установлена</p></td>
<td><p><a href="https://go.microsoft.com/fwlink/p/?linkid=510096">.NET Framework 4.5.2</a></p></td>
</tr>
<tr class="even">
<td><p><strong>Загрузка:</strong> обновление для 64-разрядной версии Windows Server 2008 R2</p></td>
<td><p><a href="https://go.microsoft.com/fwlink/p/?linkid=236954">Обновление для 64-разрядного выпуска Windows Server 2008 R2</a></p></td>
<td><p>Неприменимо</p></td>
<td><p>Неприменимо</p></td>
</tr>
<tr class="odd">
<td><p><strong>Загрузка:</strong> Windows PowerShell 3.0</p></td>
<td><p><a href="https://go.microsoft.com/fwlink/p/?linkid=244693">Windows PowerShell 3.0</a></p></td>
<td><p>Уже установлено</p></td>
<td><p>Уже установлено</p></td>
</tr>
<tr class="even">
<td><p><strong>Роль сервера:</strong> веб-сервер (IIS)</p></td>
<td><p>Вот минимальные требования к службам ролей, предъявляемые ролью сервера <strong>Веб-сервер (IIS)</strong>.</p>
<p><strong>Основные возможности HTTP</strong></p>
<ul>
<li><p>Статическое содержимое</p></li>
<li><p>Документ по умолчанию</p></li>
</ul>
<p><strong>Разработка приложений</strong></p>
<ul>
<li><p>ASP.NET</p></li>
<li><p>Расширяемость платформы .NET</p></li>
<li><p>Расширения ISAPI</p></li>
<li><p>Фильтры ISAPI</p></li>
<li><p>Компоненты на стороне сервера</p></li>
</ul>
<p><strong>Безопасность</strong></p>
<ul>
<li><p>Проверка подлинности Windows</p></li>
<li><p>Фильтрация запросов</p></li>
</ul>
<p><strong>Средства управления</strong></p>
<ul>
<li><p>Консоль управления IIS</p></li>
</ul>
<p>Следующие компоненты рекомендуются к установке, но не являются обязательными.</p>
<p><strong>Производительность</strong></p>
<ul>
<li><p>Сжатие статического содержимого</p></li>
<li><p>Сжатие динамического содержимого</p></li>
</ul></td>
<td><p>Вот минимальные требования к службам ролей, предъявляемые ролью сервера <strong>Веб-сервер (IIS)</strong>.</p>
<p><strong>Средства управления</strong></p>
<ul>
<li><p>Консоль управления IIS</p></li>
</ul>
<p><strong>Веб-сервер</strong></p>
<ul>
<li><p>Основные возможности HTTP</p></li>
<li><p>Документ по умолчанию</p></li>
<li><p>Статическое содержимое</p></li>
</ul>
<p><strong>Безопасность</strong></p>
<ul>
<li><p>Фильтрация запросов</p></li>
<li><p>Проверка подлинности Windows</p></li>
</ul>
<p><strong>Разработка приложений</strong></p>
<ul>
<li><p>Расширяемость платформы .NET 4.5</p></li>
<li><p>ASP.NET 4.5</p></li>
<li><p>Расширения ISAPI</p></li>
<li><p>Фильтры ISAPI</p></li>
<li><p>Компоненты на стороне сервера</p></li>
</ul>
<p>Приведенные ниже службы рекомендуются к установке, но не являются обязательными.</p>
<p><strong>Производительность</strong></p>
<ul>
<li><p>Сжатие статического содержимого</p></li>
<li><p>Сжатие динамического содержимого</p></li>
</ul></td>
<td><p>Вот минимальные требования к службам ролей, предъявляемые ролью сервера <strong>Веб-сервер (IIS)</strong>.</p>
<p><strong>Средства управления</strong></p>
<ul>
<li><p>Консоль управления IIS</p></li>
</ul>
<p><strong>Веб-сервер</strong></p>
<ul>
<li><p>Основные возможности HTTP</p></li>
<li><p>Документ по умолчанию</p></li>
<li><p>Статическое содержимое</p></li>
</ul>
<p><strong>Безопасность</strong></p>
<ul>
<li><p>Фильтрация запросов</p></li>
<li><p>Проверка подлинности Windows</p></li>
</ul>
<p><strong>Разработка приложений</strong></p>
<ul>
<li><p>Расширяемость платформы .NET 4.5</p></li>
<li><p>ASP.NET 4.5</p></li>
<li><p>Расширения ISAPI</p></li>
<li><p>Фильтры ISAPI</p></li>
<li><p>Компоненты на стороне сервера</p></li>
</ul>
<p>Приведенные ниже службы рекомендуются к установке, но не являются обязательными.</p>
<p><strong>Производительность</strong></p>
<ul>
<li><p>Сжатие статического содержимого</p></li>
<li><p>Сжатие динамического содержимого</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><p><strong>Компонент:</strong> службы рукописного ввода</p></td>
<td><p><strong>Службы рукописного ввода</strong></p>
<ul>
<li><p>Поддержка рукописного ввода</p></li>
</ul></td>
<td><p><strong>Службы рукописного ввода</strong></p>
<ul>
<li><p>Поддержка рукописного ввода не требуется.</p></li>
</ul></td>
<td><p><strong>Службы рукописного ввода</strong></p>
<ul>
<li><p>Поддержка рукописного ввода не требуется.</p></li>
</ul></td>
</tr>
</tbody>
</table>


## Поддержка виртуализации на сервере Office Web Apps

Сервер Office Web Apps полностью поддерживается при развертывании с использованием технологии Windows ServerHyper-V. Если вы планируете виртуализацию Сервер Office Web Apps, следуйте приведенным ниже рекомендациям.

  - Устанавливайте Сервер Office Web Apps на отдельный экземпляр виртуальной машины. Не устанавливайте на этот экземпляр другие серверные приложения, например SharePoint 2013.

  - При необходимости вы можете установить Сервер Office Web Apps на экземпляр виртуальной машины, размещенный на сервере, на котором работает SharePoint 2013.

  - В фермах серверов Сервер Office Web Apps с несколькими серверами каждый экземпляр должен размещаться на отдельной виртуальной машине, что позволит обеспечить доступность фермы серверов Сервер Office Web Apps даже в случае отказа одного из узлов.

## Требования сервера Office Web Apps к брандмауэру

Брандмауэры могут блокировать обмен данными между браузером, серверами с Сервер Office Web Apps и серверами SharePoint 2013. Это доставляет особые проблемы, когда данные серверы размещены в разных сегментах сети.

Убедитесь, что брандмауэр не блокирует следующие порты на сервере с Сервер Office Web Apps или в подсистеме балансировки нагрузки:

  - порт 443 для трафика HTTPS;

  - порт 80 для трафика HTTP;

  - порт 809 для закрытого трафика между серверами с Сервер Office Web Apps в ферме с несколькими серверами.

## Требования сервера Office Web Apps к подсистеме балансировки нагрузки

Если Сервер Office Web Apps работает на нескольких серверах, мы советуем использовать подсистему балансировки нагрузки. Выбор решения балансировки определяющей роли не играет. Вы можете использовать, например, сервер с ролью веб-сервера IIS и модулем маршрутизации запросов приложений (ARR). Фактически вы можете запускать модуль ARR на одном из серверов с Сервер Office Web Apps. Если вы еще не используете решение для балансировки нагрузки, ознакомьтесь со следующими материалами по применению IIS с ARR.

  - [Установка модуля маршрутизации запросов приложений](https://go.microsoft.com/fwlink/?linkid=236955)

  - [Справка по модулю маршрутизации запросов приложений](https://go.microsoft.com/fwlink/?linkid=236956)

В идеальном случае выбранное вами решение для балансировки нагрузки должно поддерживать следующие функции:

  - маршрутизация уровня 7;

  - поддержка сходства клиентов и интерфейсных компонентов;

  - поддержка разгрузки SSL.

Если вы используете подсистему балансировки нагрузки, вам необходимо установить в нее соответствующий сертификат (см. раздел Защита данных, передаваемых сервером Office Web Apps, с помощью протокола HTTPS этой статьи).

## Требования сервера Office Web Apps к службе доменных имен

В средах с протоколом HTTPS и балансировкой нагрузки вам необходимо настроить службу доменных имен на сопоставление полного доменного имени сертификата с IP-адресом сервера с Сервер Office Web Apps или IP-адресом, назначенным подсистеме балансировки нагрузки в ферме Сервер Office Web Apps.

## Планирование языковых пакетов для сервера Office Web Apps

Языковые пакеты Сервер Office Web Apps 2013 позволяют пользователям с помощью веб-браузера просматривать многоязычные файлы Office из библиотек документов SharePoint 2013, Outlook Web App (в виде предварительного просмотра вложений) и Lync 2013 (в виде широковещательных презентаций PowerPoint). Обратите внимание, что эти возможности зависят от настроенных на узле языков. Чтобы просматривать с помощью браузера файлы Office с узлов на нескольких языках, необходимо соблюдать следующие условия:

  - Узел (такой как SharePoint Server 2013 или Lync Server 2013) настроен для запуска приложений на дополнительных языках. Установка и настройка языковых пакетов в узле осуществляется независимо от фермы Сервер Office Web Apps.

  - Языки установлены и доступны на всех серверах в ферме Сервер Office Web Apps.

Скачать языковые пакеты для сервера Office Web Apps можно [здесь](https://go.microsoft.com/fwlink/p/?linkid=263945).

## Планирование топологии для сервера Office Web Apps

Топология Сервер Office Web Apps должна включать как минимум одну физическую или виртуальную машину с Сервер Office Web Apps и по крайней мере один узел (например, сервер с Lync Server 2013 или SharePoint 2013). Кроме того, вам потребуется клиентский компьютер или устройство для подключения к одному из узлов и использования функций Office Web Apps. К минимальной топологии фермы Сервер Office Web Apps можно добавлять узлы и серверы в зависимости от потребностей организации.

Ниже приведен список рекомендаций на случай, если топология Сервер Office Web Apps становится более сложной.

  - **Спланируйте резервирование.** Если вы используете экземпляры виртуальных машин, для эффективного резервирования их необходимо размещать на отдельных узлах виртуальных машин. При этом на других экземплярах такого компьютера могут выполняться серверные приложения. Обратите внимание, что серверные приложения не должны выполняться на одном экземпляре с Сервер Office Web Apps.

  - **Используйте один центр обработки данных.** Серверы фермы Сервер Office Web Apps должны находиться в одном центре обработки данных. Не распространяйте их географически. В целом, вам нужна только одна ферма, если только требования безопасности не предвидят изолированную сеть с собственной фермой Сервер Office Web Apps.

  - **Чем ближе узлы друг к другу, тем лучше.** Ферма Сервер Office Web Apps не должна находиться в том же центре обработки данных, что и обслуживаемые ею узлы, но при большом объеме операций редактирования мы советуем размещать ферму Сервер Office Web Apps как можно ближе к узлам. Эта рекомендация в меньшей степени относится к организациям, в которых Office Web Apps используется преимущественно для просмотра файлов Office.

  - **Спланируйте подключения.** Подключите все серверы в ферме Сервер Office Web Apps друг к другу. Чтобы подключить их к расширенной сети, используйте брандмауэр подсистемы балансировки нагрузки обратного прокси-сервера.

  - **Настройте брандмауэр для запросов HTTP или HTTPS.** Убедитесь, что брандмауэр разрешает серверам Сервер Office Web Apps инициировать HTTP- и HTTPS-запросы к узлам.

  - **Спланируйте потоки входящих и исходящих данных.** В развертывании для Интернета маршрутизируйте все исходящие данные через устройство NAT. В ферме с несколькими серверами включите обработку всех входящих данных с подсистемой балансировки нагрузки.

  - **Убедитесь, что все серверы в ферме Сервер Office Web Apps присоединены к домену и являются частью одного и того же подразделения.** Используйте параметр **FarmOU** в командлете [New-OfficeWebAppsFarm](https://docs.microsoft.com/en-us/powershell/module/officewebapps/new-officewebappsfarm?view=officewebapps-ps), чтобы запретить другим серверам, не входящим в это подразделение, присоединяться к ферме.

  - **Используйте HTTPS для всех входящих запросов.**

  - **Если в вашей сети развернут протокол IPsec, используйте его для шифрования трафика, передаваемого между серверами.**

  - **Спланируйте функции Office, для работы которых необходимо подключение к Интернету.** Если необходимы такие функции, как коллекция картинок и службы машинного перевода, а серверы в ферме не могут отправлять запросы в Интернет, необходимо настроить прокси-сервер для фермы Сервер Office Web Apps. Это позволит отправлять запросы внешним сайтам по протоколу HTTP.

## Планирование системы безопасности для сервера Office Web Apps

Следующие сведения представляют собой руководство по безопасности для Сервер Office Web Apps.

## Защита данных, передаваемых сервером Office Web Apps, с помощью протокола HTTPS

Сервер Office Web Apps может обмениваться данными с SharePoint 2013 и Lync Server 2013 по протоколу HTTPS. Мы настоятельно советуем использовать именно этот протокол в рабочих средах. Обратите внимание, что вам необходимо установить сертификат интернет-сервера, который можно назначить серверу с Сервер Office Web Apps (ферма с одним сервером) или подсистеме балансировки нагрузки (ферма с несколькими серверами Сервер Office Web Apps).

В тестовых средах, которые не содержат пользовательских данных, вы можете использовать протокол HTTP для SharePoint 2013, не устанавливая сертификат. Lync Server 2013 поддерживает только протокол HTTPS.

Сертификаты, используемые Сервер Office Web Apps, должны удовлетворять перечисленным ниже требованиям.

  - Сертификат должен быть выдан доверенным центром сертификации и должен содержать полное доменное имя фермы серверов Сервер Office Web Apps в поле альтернативного имени субъекта (SAN). Если полное доменное имя указано в другом поле, при попытке использовать сертификат браузер отображает предупреждение системы безопасности или не обрабатывает ответ.

  - Сертификат должен содержать экспортируемый закрытый ключ. В фермах, состоящих из одного сервера, этот параметр будет выбран по умолчанию, если для импорта сертификата используется оснастка диспетчера Службы IIS.

  - Поле "Понятное имя" должно содержать значение, уникальное на уровне хранилища доверенных корневых центров сертификации. При наличии нескольких сертификатов с одинаковым понятным именем не удастся создать ферму, так как командлету New-OfficeWebAppsFarm не удастся выбрать используемый сертификат.

  - Для Сервер Office Web Apps не требуется никаких особых свойств и расширений сертификата, например расширения EKU или серверного EKU.

  - В Windows Server 2012 или Windows Server 2012 R2 необходимо установить функцию "Разрешить HTTP-активацию" для Windows Communication Foundation (WCF).

Вот как необходимо импортировать сертификат.

  - **Для ферм, состоящих из одного сервера**. Необходимо импортировать сертификат непосредственно на сервер с Сервер Office Web Apps. Не выполняйте привязку сертификата вручную. Используйте для этой цели командлет New-OfficeWebAppsFarm. Если вы привяжете сертификат вручную, он будет удаляться при каждой перезагрузке сервера.

  - **Для ферм с балансировкой нагрузки**. Если вы разгружаете SSL, необходимо импортировать сертификат на устройство балансировки нагрузки. Если вы не разгружаете SSL, установите сертификат на каждый сервер в ферме серверов Сервер Office Web Apps.

> [!NOTE]
> Не используйте самозаверяющие сертификаты. Их можно использовать только в некритических тестовых средах.


Дополнительные сведения о сертификатах см. в разделе [Получение SSL-сертификата](https://go.microsoft.com/fwlink/p/?linkid=269700).

## Использование разгрузки SSL для устройств балансировки нагрузки

При настройке новой фермы Сервер Office Web Apps разгрузка SSL выключена по умолчанию. Если вы используете подсистему балансировки нагрузки, советуем включить разгрузку SSL. Это позволяет каждому Сервер Office Web Apps в ферме обмениваться данными с подсистемой балансировки нагрузки, используя протокол HTTP. Кроме того, включение разгрузки SSL дает следующие преимущества:

  - Упрощенное управление сертификатами

  - Усовершенствованное мягкое сходство

  - Повышенная производительность

Учтите, что при использовании HTTP трафик, передаваемый из подсистемы балансировки нагрузки на серверы, на которых работает Сервер Office Web Apps, не шифруется, поэтому необходимо убедиться, что сеть защищена. Чтобы защитить трафик, можно использовать частную подсеть.

## Запрет на присоединение серверов к ферме серверов Office Web Apps по их принадлежности к подразделениям

Чтобы запретить нежелательным серверам присоединяться к ферме Сервер Office Web Apps, вы можете создать для них отдельное подразделение и соответствующим образом настроить параметр FarmOU при создании фермы. Дополнительные сведения о параметре FarmOU см. в статье [New-OfficeWebAppsFarm](https://docs.microsoft.com/en-us/powershell/module/officewebapps/new-officewebappsfarm?view=officewebapps-ps).

## Ограничение доступа узлов к серверу Office Web Apps с помощью списка разрешений

С помощью списка разрешений вы можете запретить подключение нежелательных узлов к ферме Сервер Office Web Apps, что могло бы повлечь за собой операции с файлами без вашего согласия. Чтобы ограничить список узлов, которые смогут выполнять операции запроса файлов (например, извлечение и изменение файлов или извлечение метаданных) к Сервер Office Web Apps, добавьте нужные домены в список разрешенных.

Вы можете добавлять домены в список разрешенных уже после создания фермы Сервер Office Web Apps. Дополнительные сведения о добавлении доменов в список разрешенных см. в статье [New-OfficeWebAppsHost](https://docs.microsoft.com/en-us/powershell/module/officewebapps/new-officewebappshost?view=officewebapps-ps).

> [!IMPORTANT]
> Если в списке разрешенных отсутствуют домены, Сервер Office Web Apps принимает запросы файлов от узлов любого домена. Если ваша ферма Сервер Office Web Apps доступна через Интернет, не оставляйте этот список пустым. В противном случае просматривать и редактировать контент смогут любые пользователи с доступом к вашей ферме Сервер Office Web Apps.


## Планирование Online Viewers с использованием сервера Office Web Apps

По умолчанию функция Online Viewers включается после установки Сервер Office Web Apps. Если вы планируете использовать Online Viewers в организации, ознакомьтесь со следующими рекомендациями. В некоторых случаях может потребоваться отключить некоторые возможности Online Viewers. Приведенные ниже рекомендации относятся к параметрам, заданным с помощью командлетов Windows PowerShell[New-OfficeWebAppsFarm](https://docs.microsoft.com/en-us/powershell/module/officewebapps/new-officewebappsfarm?view=officewebapps-ps) и [Set-OfficeWebAppsFarm](https://docs.microsoft.com/en-us/powershell/module/officewebapps/set-officewebappsfarm?view=officewebapps-ps).

## Рекомендации по обеспечению безопасности для Online Viewers

Файлы, которые предназначены для просмотра в веб-браузере с помощью Online Viewers, не должны требовать проверки подлинности. Другими словами, они должны находиться в открытом доступе, так как Online Viewers не поддерживает проверку подлинности при извлечении файлов. Мы настоятельно рекомендуем реализовать доступ к ферме Сервер Office Web Apps с Online Viewers либо только из интрасети, либо только из Интернета, но не из обеих сетей одновременно. Это связано с тем, что Сервер Office Web Apps не различает запросы URL-адресов в интрасети и Интернете. Соответственно, при поступлении из Интернета запроса к URL-адресу в интрасети возможна утечка данных в результате передачи документа для внутреннего пользования сторонним лицам.

По той же причине, если сервер Сервер Office Web Apps должен подключаться только к Интернету, мы настоятельно советуем отключить поддержку UNC в Online Viewers. Чтобы сделать это, присвойте параметру OpenFromUncEnabled значение False с помощью командлетов Windows PowerShell[New-OfficeWebAppsFarm](https://docs.microsoft.com/en-us/powershell/module/officewebapps/new-officewebappsfarm?view=officewebapps-ps) (для новых ферм) или [Set-OfficeWebAppsFarm](https://docs.microsoft.com/en-us/powershell/module/officewebapps/set-officewebappsfarm?view=officewebapps-ps) (для существующих ферм).

В качестве дополнительных мер безопасности с помощью Online Viewers можно просматривать файлы Office размером не более 10 МБ.

## Настройка параметров Online Viewers

Для настройки Online Viewers вы можете использовать следующие параметры Windows PowerShell в командлетах [New-OfficeWebAppsFarm](https://docs.microsoft.com/en-us/powershell/module/officewebapps/new-officewebappsfarm?view=officewebapps-ps) (для новых ферм) и [Set-OfficeWebAppsFarm](https://docs.microsoft.com/en-us/powershell/module/officewebapps/set-officewebappsfarm?view=officewebapps-ps) (для существующих ферм).

  - **OpenFromUrlEnabled**.   Включает или отключает Online Viewers. Этот параметр управляет функцией Online Viewers для файлов с URL-адресами и UNC-путями. По умолчанию при создании новой фермы Сервер Office Web Apps ему присвоено значение False (отключено).

  - **OpenFromUncEnabled**. Если функция Online Viewers включена (параметр OpenFromUrlEnabled имеет значение True), этот параметр включает или отключает функцию просмотра файлов по UNC-путям в Online Viewers. По умолчанию этому параметру присвоено значение True. Прежде чем разрешать открытие файлов по UNC-путям, убедитесь, что параметру OpenFromUrlEnabled также присвоено значение True. Как упоминалось выше, если Сервер Office Web Apps настроен на подключение к Интернету, мы советуем присвоить этому параметру значение False.

  - **OpenFromUrlThrottlingEnabled**. Ограничивает количество открытых запросов URL-адресов с одного сервера за указанный период. Ограничения по умолчанию недоступны для настройки. Это позволяет защитить ферму Сервер Office Web Apps от избыточного количества запросов на просмотр контента в Online Viewers с одного сервера.

## Планирование обновлений сервера Office Web Apps

Перед развертыванием Сервер Office Web Apps необходимо решить, как в организации будет осуществляться управление обновлениями программного обеспечения для фермы Сервер Office Web Apps. Хотя обновления программного обеспечения помогают повысить безопасность, производительность и надежность сервера, неправильная установка обновлений может привести к проблемам с Сервер Office Web Apps.

Применение обновлений Сервер Office Web Apps с помощью процесса автоматического обновления Майкрософт не поддерживается в Сервер Office Web Apps. Это связано с тем, что обновления для Сервер Office Web Apps необходимо применять определенным способом, как это описано в разделе [Применение обновлений программного обеспечения к серверу Office Web Apps](apply-software-updates-to-office-web-apps-server.md). Если применять обновления Сервер Office Web Apps автоматически, может получиться так, что пользователи не смогут просматривать и изменять документы в Office Web Apps. В этом случае необходимо перестроить ферму Сервер Office Web Apps.

Мы советуем управлять обновлениями с помощью служб Windows Server Update Services (WSUS) или средства System Center Диспетчер конфигураций, которое использует службы WSUS. Эти службы позволяют полностью управлять распространением выпущенных обновлений через Центр обновления Майкрософт для каждого сервера в ферме Сервер Office Web Apps. Используя службы WSUS, можно указывать, какие обновления будут автоматически применены к ферме серверов, а какие (например, обновления Сервер Office Web Apps) — вручную. Подробнее о службах WSUS см. в статье [Службы обновления Windows Server](https://go.microsoft.com/fwlink/p/?linkid=294822).

Если вы не используете службы WSUS или System Center Диспетчер конфигураций, задайте для автоматического обновления Майкрософт на каждом сервере в ферме Сервер Office Web Apps режим **Загружать обновления, но решение об установке принимается мной**. Когда появится уведомление об обновлении Сервер Office Web Apps, выполните указания, описанные в разделе [Применение обновлений программного обеспечения к серверу Office Web Apps](apply-software-updates-to-office-web-apps-server.md). Чтобы применить обновления Windows без угроз для безопасности серверов, разрешите установку обновлений при появлении уведомления об их доступности.

## См. также


[План содержимого для сервера Office Web Apps](content-roadmap-for-office-web-apps-server.md)  
[Обзор сервера Office Web Apps](office-web-apps-server-overview.md)  
[Развертывание сервера Office Web Apps](deploy-office-web-apps-server.md)  
[Применение обновлений программного обеспечения к серверу Office Web Apps](apply-software-updates-to-office-web-apps-server.md)  


[Office.com (здесь вы найдете справку по Office Web Apps для настольного компьютера или мобильного устройства)](https://go.microsoft.com/fwlink/p/?linkid=266657)  
  

[](apply-software-updates-to-office-web-apps-server.md)

